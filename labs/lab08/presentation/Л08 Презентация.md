---
## Front matter
lang: ru-RU
title: "Лабораторная работа №8"
subtitle: Основы администрирования операционных сетей
author:
  - Бызова М.О.
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 01 января 1970

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 
## Fonts 
mainfont: PT Serif 
romanfont: PT Serif 
sansfont: PT Sans 
monofont: PT Mono 
mainfontoptions: Ligatures=TeX 
romanfontoptions: Ligatures=TeX 
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase 
monofontoptions: Scale=MatchLowercase,Scale=0.9
---

## Цель работы

Целью данной работы является получение навыков работы с планировщиками событий cron и at.

## Задание

1. Выполните задания по планированию задач с помощью crond (см. раздел 8.4.1).
2. Выполните задания по планированию задач с помощью atd (см. раздел 8.4.2).

# Выполнение лабораторной работы

## Планирование задач с помощью cron

Запустим терминал и получим полномочия администратора: su -. Просмотрим статус демона crond: systemctl status crond -l и содержимое файла конфигурации /etc/crontab: cat /etc/crontab (рис. 1).

## Планирование задач с помощью cron

![Запуск терминала и получение полномочий администратора, просмотр статуса демона crond и содержимого файла конфигурации /etc/crontab.](image/1.PNG){#fig:001 width=70%}

## Планирование задач с помощью cron

Теперь просмотрим список заданий в расписании: crontab -l. Ничего не отобразилось, так как расписание ещё не задано. Далее откроем файл расписания на редактирование: crontab -e (рис. 2).

![Просмотр списка заданий в расписании, открытие файла расписания на редактирование.](image/2.PNG){#fig:002 width=70%}

## Планирование задач с помощью cron

Предыдущая команда запустила интерфейс редактора (по умолчанию используется vi). Добавим следующую строку в файл расписания (запись сообщения в системный журнал), используя Ins для перехода в vi в режим ввода: */1 * * * * logger This message is written from root cron. Закроем сеанс редактирования vi и сохраним изменения, используя команду vi: Esc : wq. (рис. 3).

![Открытие текстового редактора vi и добавление строки в файл расписания.](image/3.PNG){#fig:003 width=70%}

## Планирование задач с помощью cron

Просмотрим список заданий в расписании: crontab -l (в расписании появилась запись о запланированном событии). Не выключая систему, через некоторое время (2–3 минуты) просмотрим журнал системных событий: grep written /var/log/messages (рис. 4).

![Просмотр списка заданий в расписании, просмотр журнала системных событий.](image/4.PNG){#fig:004 width=70%}

## Планирование задач с помощью cron

Вернёмся в текстовый редактор vi и изменим запись в расписании crontab на следующую: 0 */1 * * 1-5 logger This message is written from root cron (рис. 5).

![Изменение записи в расписании crontab.](image/5.PNG){#fig:005 width=70%}

## Планирование задач с помощью cron

Теперь просмотрим список заданий в расписании: crontab -l (рис. 6).

![Просмотр списка заданий в расписании.](image/6.PNG){#fig:006 width=70%}

## Планирование задач с помощью cron

Перейдём в каталог /etc/cron.hourly и создадим в нём файл сценария с именем eachhour (рис. 7).

![Открытие каталога /etc/cron.hourly и создание в нём файла сценария с именем eachhour.](image/7.PNG){#fig:007 width=70%}

## Планирование задач с помощью cron

Далее откроем файл eachhour для редактирования и пропишем в нём следующий скрипт (запись сообщения в системный журнал) (рис. 8).

## Планирование задач с помощью cron

![Открытие файла eachhour для редактирования и прописывание в нём скрипта.](image/8.PNG){#fig:008 width=70%}

## Планирование задач с помощью cron

Сделаем файл сценария eachhour исполняемым. Теперь перейдём в каталог /etc/crond.d и создадим в нём файл с расписанием
eachhour (рис. 9).

![Делаем файл сценария eachhour исполняемым, открытие каталога /etc/crond.d и создание в нём файла с расписанием eachhour, открытие файла на редактирование.](image/9.PNG){#fig:009 width=70%}

## Планирование задач с помощью cron

Откроем этот файл для редактирования и поместим в него следующее содержимое (рис. 10).

## Планирование задач с помощью cron

![Добавление содержимого в файл и сохранение изменений.](image/10.PNG){#fig:010 width=70%}

## Планирование задач с помощью cron

Не выключая систему, через некоторое время (2 часа) просмотрим журнал системных событий. По журналу видим, что запуск сценария eachhour в соответствии с заданным расписанием был осуществлён (рис. 11).

![Просмотр журнала системных событий через 2 часа.](image/11.PNG){#fig:011 width=70%}

## Планирование заданий с помощью at

Запустим терминал и получим полномочия администратора: su -. Проверим, что служба atd загружена и включена: systemctl status atd. Зададим выполнение команды logger message from at в 17:00. Для этого введём at 17:00, а затем logger message from at. Используем Ctrl + d, чтобы закрыть оболочку. Убедимся, что задание действительно запланировано: atq. С помощью команды grep from at /var/log/messages посмотрим, появилось ли соответствующее сообщение в лог- файле в указанное вами время (сообщение появилось) (рис. 12).

## Планирование заданий с помощью at

![Запуск терминала и получение полномочий администратора, проверка загрузки и включения службы atd, создание задачи выполнения команды logger message from at в 17:00, закрытие оболочки. Проверка планировки задачи и выполнения её в указанное время.](image/12.PNG){#fig:012 width=50%}

## Выводы

В ходе выполнения лабораторной работы были получены навыки работы с планировщиками событий cron и at.

## Список литературы{.unnumbered}

1. Робачевский А., Немнюгин С., Стесик О. Операционная система UNIX. — 2-е изд. — БХВ-Петербург, 2010.
2. Колисниченко Д. Н. Самоучитель системного администратора Linux. — СПб. : БХВ-Петербург, 2011. — (Системный администратор).
3. Таненбаум Э., Бос Х. Современные операционные системы. — 4-е изд. — СПб. : Питер, 2015. — (Классика Computer Science).
4. Neil N. J. Learning CentOS: A Beginners Guide to Learning Linux. — CreateSpace Independent Publishing Platform, 2016.
5. Unix и Linux: руководство системного администратора / Э. Немет, Г. Снайдер, Т.Хейн, Б. Уэйли, Д. Макни. — 5-е изд. — СПб. : ООО «Диалектика», 2020.

